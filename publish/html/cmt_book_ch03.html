<!DOCTYPE html>
<!DOCTYPE html>
<html lang="">
 <head>
  <title>cmt_book_ch03</title>
  <meta name="generator" content="wxMaxima"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="cmt_book_ch03_htmlimg/cmt_book_ch03.css"/>
 </head>
 <body>

<!-- ************************************************************************** -->
<!-- *        Created with wxMaxima version 20.09.0-DevelopmentSnapshot       * -->
<!-- ************************************************************************** -->
<noscript><div class="error message"><p>Please enable JavaScript in order to get a 2d display of the equations embedded in this web page.</p></div></noscript><p hidden = "hidden">\(      \DeclareMathOperator{\abs}{abs}
      \newcommand{\ensuremath}[1]{\mbox{$#1$}}
\)</p>

<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i3)	
  </span></td>
  <td><span class="input">
<span class="code_function">load</span><span class="code_operator">(</span><span class="code_variable">vect</span><span class="code_operator">)</span><span class="code_endofline">;</span> <span class="code_function">load</span><span class="code_operator">(</span><span class="code_variable">eigen</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>&quot;/usr/local/share/maxima/5.44.0/share/vector/vect.mac&quot;</mo>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>&quot;/usr/local/share/maxima/5.44.0/share/matrix/eigen.mac&quot;</mo>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Modern Electrodynamics And Coupled Mode Theory<br/>Chapter 3<br/>General Power-Energy Equations For Bianisotropic Media<br/><br/>3.2.1 Poynting's Theorem For BAM<br/><br/>2 field intensity vectors E and H<br/>2 flux density vectors D and B<br/>These are related by Maxwell's equations and the constitutive relations<br/><br/>Charge Density ρ and current density J specify the effect of mobile charges in a medium<br/><br/>Polarization vector and Magnetization vector arise from displacement of bound charges in the medium due to E and H<br/>This displacement is the polarization response of the medium as a whole to the E and H fields<br/><br/>The polarization response is specified by:<br/>P (electric polarization vector) <br/>M (magnetization or magnetic polarization vector )<br/><br/>P and M give the contributions of the displaced bound charges to the total induced electric and magnetic flux in the medium<br/><br/>TODO: DEFINE PROPER VECTOR COMPONENTS/EXPRESSIONS FOR THE FOLLOWING VECTORS<br/>THESE ARE JUST BASIC VECTOR CONSTRUCTS TO ACT AS PLACEHOLDERS FOR div, curl, dot and cross product<br/><br/>NOTE: Only for display purposes the folllowing vector definitions are repeatedly defined then killed
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i15)	
  </span></td>
  <td><span class="input">
<span class="code_variable">E</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Ex</span><span class="code_endofline">,</span><span class="code_variable">Ey</span><span class="code_endofline">,</span><span class="code_variable">Ez</span><span class="code_operator">]</span><span class="code_endofline">;</span> <span class="code_variable">H</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Hx</span><span class="code_endofline">,</span><span class="code_variable">Hy</span><span class="code_endofline">,</span><span class="code_variable">Hz</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">D</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Dx</span><span class="code_endofline">,</span><span class="code_variable">Dy</span><span class="code_endofline">,</span><span class="code_variable">Dz</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">B</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Bx</span><span class="code_endofline">,</span><span class="code_variable">By</span><span class="code_endofline">,</span><span class="code_variable">Bz</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">S</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Sx</span><span class="code_endofline">,</span><span class="code_variable">Sy</span><span class="code_endofline">,</span><span class="code_variable">Sz</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">Hk</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Hkx</span><span class="code_endofline">,</span> <span class="code_variable">Hky</span><span class="code_endofline">,</span><span class="code_variable">Hkz</span><span class="code_operator">]</span><span class="code_endofline">;</span> <span class="code_variable">Ek</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Ekx</span><span class="code_endofline">,</span> <span class="code_variable">Eky</span><span class="code_endofline">,</span><span class="code_variable">Ekz</span><span class="code_operator">]</span><span class="code_endofline">;</span> <span class="code_variable">Hl</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Hlx</span><span class="code_endofline">,</span> <span class="code_variable">Hly</span><span class="code_endofline">,</span><span class="code_variable">Hlz</span><span class="code_operator">]</span><span class="code_endofline">;</span> <span class="code_variable">El</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Elx</span><span class="code_endofline">,</span> <span class="code_variable">Ely</span><span class="code_endofline">,</span><span class="code_variable">Elz</span><span class="code_operator">]</span><span class="code_endofline">;</span> <span class="code_variable">A</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Ax</span><span class="code_endofline">,</span><span class="code_variable">Ay</span><span class="code_endofline">,</span><span class="code_variable">Az</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">E_hat</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Ehx</span><span class="code_endofline">,</span> <span class="code_variable">Ehy</span><span class="code_endofline">,</span> <span class="code_variable">Ehz</span><span class="code_operator">]</span> <span class="code_endofline">;</span> <span class="code_variable">H_hat</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Hhx</span><span class="code_endofline">,</span> <span class="code_variable">Hhy</span><span class="code_endofline">,</span> <span class="code_variable">Hhz</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Hkx</mo>
<mi>,</mi>
<mo>Hky</mo>
<mi>,</mi>
<mo>Hkz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Ekx</mo>
<mi>,</mi>
<mo>Eky</mo>
<mi>,</mi>
<mo>Ekz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Hlx</mo>
<mi>,</mi>
<mo>Hly</mo>
<mi>,</mi>
<mo>Hlz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Elx</mo>
<mi>,</mi>
<mo>Ely</mo>
<mi>,</mi>
<mo>Elz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Ax</mo>
<mi>,</mi>
<mo>Ay</mo>
<mi>,</mi>
<mo>Az</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Ehx</mo>
<mi>,</mi>
<mo>Ehy</mo>
<mi>,</mi>
<mo>Ehz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Hhx</mo>
<mi>,</mi>
<mo>Hhy</mo>
<mi>,</mi>
<mo>Hhz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i16)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_321</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span><span class="code_operator">−</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_variable">ρ</span><span class="code_endofline">,</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_endofline">,</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ez</mo>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ey</mo>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ex</mo>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ez</mo>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ey</mo>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ex</mo>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Dz</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Dy</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Dx</mo>
</mrow>
</mrow>
<mo>=</mo>
<mo>ρ</mo>
<mi>,</mi>
<mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Hz</mo>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Hy</mo>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Hz</mo>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Hy</mo>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mo>J</mo>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Bz</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>By</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Bx</mo>
</mrow>
</mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
The P and M vectors give the corresponding contributions to the electric and magnetic induction values
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i17)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_322</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">D</span><span class="code_operator">=</span><span class="code_variable">ε</span><span class="code_operator">[</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">+</span><span class="code_variable">P</span><span class="code_endofline">,</span> <span class="code_variable">B</span><span class="code_operator">=</span><span class="code_variable">μ</span><span class="code_operator">[</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">+</span><span class="code_variable">M</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>P</mo>
<mo>+</mo>
<msub><mo>ε</mo>
<mn>0</mn>
</msub>
<mo>&#8290;</mo>
<mo>Ex</mo>
<mi>,</mi>
<mo>P</mo>
<mo>+</mo>
<msub><mo>ε</mo>
<mn>0</mn>
</msub>
<mo>&#8290;</mo>
<mo>Ey</mo>
<mi>,</mi>
<mo>P</mo>
<mo>+</mo>
<msub><mo>ε</mo>
<mn>0</mn>
</msub>
<mo>&#8290;</mo>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mi>,</mi>
<mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><msub><mo>μ</mo>
<mn>0</mn>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mo>Hx</mo>
</mrow>
<mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>μ</mo>
<mn>0</mn>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mo>Hy</mo>
</mrow>
<mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>μ</mo>
<mn>0</mn>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mo>Hz</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
The conventional procedure applied to (3.2.1 ) above gives the usual form of Poynting's Theorem
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i18)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_323</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_variable">J</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>−</mo>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
<mo>−</mo>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>−</mo>
<mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mo>J</mo>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><mo>−</mo>
<mo>Ex</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ey</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Equation (3.2.1) can be rewritten in a form involving the instantaneous values of the power-energy  quantities<br/><br/>w   electromagnetic energy density<br/>S   electromagnetic flux density (Poynting's Vector)
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i19)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_324</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">w</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">.</span><span class="code_variable">D</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_variable">B</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_endofline">,</span> <span class="code_variable">S</span> <span class="code_operator">=</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_endofline">~</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_endofline">,</span>  <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">w</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">−</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span><span class="code_operator">−</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_operator">−</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>w</mo>
<mo>=</mo>
<mfrac><mrow><mo>Bz</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>+</mo>
<mo>By</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>+</mo>
<mo>Bx</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
<mo>+</mo>
<mo>Dz</mo>
<mo>&#8290;</mo>
<mo>Ez</mo>
<mo>+</mo>
<mo>Dy</mo>
<mo>&#8290;</mo>
<mo>Ey</mo>
<mo>+</mo>
<mo>Dx</mo>
<mo>&#8290;</mo>
<mo>Ex</mo>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>−</mo>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mi>,</mi>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
<mo>−</mo>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mi>,</mi>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>−</mo>
<mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
<mo>]</mo></mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>w</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Sz</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Sy</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Sx</mo>
</mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
<mo>−</mo>
<msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>−</mo>
<msub><mo>I</mo>
<mo>J</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
The terms on the rhs of (3.2.4) are:
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i20)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_325</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_variable">J</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>I</mo>
<mo>J</mo>
</msub>
<mo>=</mo>
<mo>J</mo>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i21)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_326</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">−</span><span class="code_operator">(</span><span class="code_variable">P</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>I</mo>
<mo>P</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>P</mo>
</mrow>
</mrow>
<mo>−</mo>
<mo>P</mo>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i22)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_327</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">μ_0</span><span class="code_operator">·</span><span class="code_variable">M</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">−</span><span class="code_variable">μ_0</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">M</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
These reflect the properties of the specfiic medium considered<br/>They give the instantaneous power of interaction between the E and H fields and charges in the medium<br/>They take into account both the mobile current-carrying charges  J and bound charges causing the polarizations P and M<br/><br/>If the permittivity (ε_bar) and permeability (μ_bar) tensors are symmetrical (Linear Homogenous Isotropic Materials)<br/>them ∂w/∂t = (E . ∂D/∂t + (H . ∂B/∂t). Then D=ε_bar*E and B = μ_bar*H<br/><br/>Normally I[J] is the only interaction term considered and the other 2 are dropped without justification<br/>However, I[P] and I[M] make important contributions to the power-energy equation.<br/><br/>For harmonic (time-varying) fields of form exp(iωt) we consider the time-average values of the power-energy components.<br/>Then ∂w/∂t = 0 and (3.2.4) changes form to use the time-average values of the power-energy components.<br/><br/>Time-average values are represented in the textbook as &lt;...&gt; but I define 2 functions below for this purpose.<br/>There may be a way to use &lt;| and |&gt; as a time-average operator bracket pair, but for now functions will do.<br/>cta gives the discrete time-average<br/>dta gives the continous time_average<br/>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i23)	
  </span></td>
  <td><span class="input">
<span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">f</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">:</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">f</span><span class="code_endofline">,</span><span class="code_variable">n</span><span class="code_endofline">,</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mi>dta</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>f</mo>
<mi>,</mi>
<mo>N</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>:=</mi>
<mfrac><mn>1</mn>
<mo>N</mo>
</mfrac>
<mo>&#8290;</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>n</mo>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>N</mo>
</munderover><mo>f</mo>
</mrow></mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i24)	
  </span></td>
  <td><span class="input">
<span class="code_function">cta</span><span class="code_operator">(</span><span class="code_variable">f</span><span class="code_endofline">,</span><span class="code_variable">v</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">:</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">f</span><span class="code_endofline">,</span><span class="code_variable">v</span><span class="code_endofline">,</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mi>cta</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>f</mo>
<mi>,</mi>
<mo>v</mo>
<mi>,</mi>
<mo>N</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>:=</mi>
<mfrac><mn>1</mn>
<mo>N</mo>
</mfrac>
<mo>&#8290;</mo>
<mrow><munderover><mo>&#x222B;</mo><mn>0</mn>
<mo>N</mo>
</munderover>
<mo>f</mo>
<mrow><mo>d</mo>
<mo>v</mo>
</mrow>
</mrow></mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i25)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_328</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_endofline">,</span><span class="code_variable">M</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_operator">=</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">M</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_function">dta</span><span class="code_operator">(</span> <span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">M</span><span class="code_operator">)</span> <span class="code_operator">−</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">M</span> <span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sz</mo>
</mrow>
<mo>M</mo>
</mfrac>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sy</mo>
</mrow>
<mo>M</mo>
</mfrac>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sx</mo>
</mrow>
<mo>M</mo>
</mfrac>
</mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>M</mo>
</mfrac>
<mo>−</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>M</mo>
</msub>
</mrow>
<mo>M</mo>
</mfrac>
<mo>+</mo>
<mfrac><mrow><msub><mo>I</mo>
<mo>J</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>M</mo>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
The values of the constitutive relations linking the induction vectors P and M to the field vectors E and H and flux vectors D and B must be known in order to calculate expressions (3.2.5)-(3.2.7).There is more than one form of the constitutive relations for bianisotropic media. Barybin selects these ones:
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i26)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_329</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">D</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_endofline">.</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_operator">+</span><span class="code_operator">(</span><span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i27)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3210</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">B</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_variable">ζ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_variable">μ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">h</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mo>h</mo>
<mo>+</mo>
<msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Four constitutive parameters are 2-argument functions of frequency ε_bar, μ_bar, ξ_bar, ζ_bar.<br/>Their values and forms depend on the medium being analyzed.<br/>They describe all the special cases of media without  -&gt;spatial&lt;-  dispersion.<br/><br/>I_bar is the identity matrix (diagonal matrix with 1's on the diagonal)
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i28)	
  </span></td>
  <td><span class="input">
<span class="code_variable">I_bar</span><span class="code_operator">:</span><span class="code_function">ident</span><span class="code_operator">(</span><span class="code_number">3</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>1</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>1</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>1</mn>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
For isotropic media
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i29)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3211</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">ε_bar</span><span class="code_operator">=</span><span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span><span class="code_variable">ξ_bar</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">ζ_bar</span><span class="code_operator">=</span><span class="code_number">0</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mo>ε</mo>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mo>ε</mo>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mo>ε</mo>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
<mi>,</mi>
<msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
For double anisotropic media
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i30)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3212</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">ε_bar</span> <span class="code_operator">#</span> <span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span><span class="code_variable">μ_bar</span> <span class="code_operator">#</span> <span class="code_variable">μ</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span><span class="code_variable">ξ_bar</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">ζ_bar</span><span class="code_operator">=</span><span class="code_number">0</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mi>#</mi>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mo>ε</mo>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mo>ε</mo>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mo>ε</mo>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mi>#</mi>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mo>μ</mo>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mo>μ</mo>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mo>μ</mo>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
<mi>,</mi>
<msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
For chiral (asymmetric bi-isotropic) media<br/><br/>where <br/>ε_0 is the permittivity of free space<br/>μ_0 is the permeability of free space<br/>Χ is Tellegen's parameter of nonreciprocity<br/>κ is Pasteur's parameter of chirality
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i31)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3213</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">ε_bar</span><span class="code_operator">=</span><span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span> <span class="code_variable">μ_bar</span><span class="code_operator">=</span><span class="code_variable">μ</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span> <span class="code_variable">ξ_bar</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_variable">χi</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">κ</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">sqrt</span><span class="code_operator">(</span><span class="code_variable">ε_0</span><span class="code_operator">·</span><span class="code_variable">μ_0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span> <span class="code_variable">ζ_bar</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_variable">Χ</span><span class="code_operator">+</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">κ</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">sqrt</span><span class="code_operator">(</span><span class="code_variable">ε_0</span><span class="code_operator">·</span><span class="code_variable">μ_0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mo>ε</mo>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mo>ε</mo>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mo>ε</mo>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mo>μ</mo>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mo>μ</mo>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mo>μ</mo>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><msqrt><mrow><msub><mo>ε</mo>
<mo>0</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
</msqrt>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>χi</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>κ</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mrow><msqrt><mrow><msub><mo>ε</mo>
<mo>0</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
</msqrt>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>χi</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>κ</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mrow><msqrt><mrow><msub><mo>ε</mo>
<mo>0</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
</msqrt>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>χi</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>κ</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><mrow><mo>(</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>κ</mo>
<mo>+</mo>
<mo>Χ</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msqrt><mrow><msub><mo>ε</mo>
<mo>0</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
</msqrt>
</mrow>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mrow><mrow><mo>(</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>κ</mo>
<mo>+</mo>
<mo>Χ</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msqrt><mrow><msub><mo>ε</mo>
<mo>0</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
</msqrt>
</mrow>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mrow><mrow><mo>(</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>κ</mo>
<mo>+</mo>
<mo>Χ</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msqrt><mrow><msub><mo>ε</mo>
<mo>0</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
</msqrt>
</mrow>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
For bianisotropic media without losses <br/>ε_bar and μ_bar are hermitian (self-adjoint)<br/>ξ_bar and ζ_bar are hermitian conjugate (mutually adjoint)<br/><br/>Note: dagger means the hermitian conjugate operation (transpose composed with complex conjugation)<br/><br/>This means that:
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i32)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3214</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">ε_bar</span><span class="code_operator">=</span><span class="code_variable">ε_bar_dagger</span><span class="code_endofline">,</span> <span class="code_variable">μ_bar</span> <span class="code_operator">=</span> <span class="code_variable">μ_bar_dagger</span><span class="code_endofline">,</span> <span class="code_variable">ξ_bar</span><span class="code_operator">=</span><span class="code_variable">ζ_bar_dagger</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mo>ε_bar_dagger</mo>
<mi>,</mi>
<msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mo>μ_bar_dagger</mo>
<mi>,</mi>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mo>ζ_bar_dagger</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
The relations in (3.2.14) imply some conditions for the case of lossy media.<br/>The anti-hermitian components <br/>ε_bar_a = (ε_bar-ε_bar_dagger)/2<br/>μ-bar_a=(μ_bar-μ_bar_dagger)/2<br/>and <br/>the difference (ξ_bar-ζ_bar_dagger) <br/>cause the losses (dieletric, magnetic and electromagnetic).<br/><br/>If the medium has conductivity σ_bar_c that causes electric losses then another  constitutive relation is required:<br/>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i33)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3215</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">=</span><span class="code_variable">σ_bar_c</span><span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>J</mo>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mo>&#8290;</mo>
<msub><mo>σ_bar</mo>
<mo>c</mo>
</msub>
<mi>,</mi>
<mo>Ey</mo>
<mo>&#8290;</mo>
<msub><mo>σ_bar</mo>
<mo>c</mo>
</msub>
<mi>,</mi>
<mo>Ez</mo>
<mo>&#8290;</mo>
<msub><mo>σ_bar</mo>
<mo>c</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Calculate the terms on the right side of (3.2.8) by using (3.2.5)-(3.2.7) and the constitutive relations (3.2.9),(3.2.10),(3.2.15)<br/>Re and Im are defined as realpart and imagpart for convenience
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i35)	
  </span></td>
  <td><span class="input">
<span class="code_function">Im</span><span class="code_operator">(</span><span class="code_variable">cv</span><span class="code_operator">)</span><span class="code_operator">:</span><span class="code_operator">=</span><span class="code_function">imagpart</span><span class="code_operator">(</span><span class="code_variable">cv</span><span class="code_operator">)</span><span class="code_endofline">;</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">cv</span><span class="code_operator">)</span><span class="code_operator">:</span><span class="code_operator">=</span><span class="code_function">realpart</span><span class="code_operator">(</span><span class="code_variable">cv</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mi>Im</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>cv</mo>
<mo>)</mo></mrow>
</mrow>
<mi>:=</mi>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>cv</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>cv</mo>
<mo>)</mo></mrow>
</mrow>
<mi>:=</mi>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>cv</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i36)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3216</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">N</span> <span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">J</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">jJ</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar_c</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">jJ</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">σ_bar_c</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><msub><mo>I</mo>
<mo>J</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><msub><mo>I</mo>
<mo>J</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mi>,</mi>
<mfrac><mrow><msub><mo>I</mo>
<mo>J</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>J</mo>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>jJ</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<msub><mo>σ_bar</mo>
<mo>c</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>jJ</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><msub><mo>σ_bar</mo>
<mo>c</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i37)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3217</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">P</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_endofline">.</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">D</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">D</span><span class="code_operator">)</span>  <span class="code_operator">−</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">ε_bar</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_operator">−</span> <span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_operator">−</span> <span class="code_variable">ε_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_operator">+</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">ξ_bar</span> <span class="code_endofline">,</span> <span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">ε_bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_operator">+</span>  <span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>P</mo>
</mrow>
</mrow>
<mo>−</mo>
<mo>P</mo>
<mo> . </mo>
<mrow><mi>del</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mo>t</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mn>2</mn>
<mo>&#8290;</mo>
<mo>N</mo>
</mrow>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mn>2</mn>
<mo>&#8290;</mo>
<mo>N</mo>
</mrow>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mover accent="true"><mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>Ey</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>Dx</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Dy</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Dz</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><mn>0</mn>
<mi>,</mi>
<mn>0</mn>
<mi>,</mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
<mo>&#8290;</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mover accent="true"><mrow><mo>[</mo><mrow><mo>Dx</mo>
<mi>,</mi>
<mo>Dy</mo>
<mi>,</mi>
<mo>Dz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<mo>Ex</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ey</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<mo>Ex</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ey</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<mo>Ex</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ey</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mn>0</mn>
<mi>,</mi>
<mn>0</mn>
<mi>,</mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>I</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>a</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i38)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3218</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">μ_0</span><span class="code_operator">·</span><span class="code_variable">M</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_variable">μ_0</span><span class="code_operator">·</span><span class="code_variable">M</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">B</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">B</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">μ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_operator">−</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjguate</span><span class="code_operator">(</span><span class="code_variable">ζ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">μ_bar</span> <span class="code_operator">−</span> <span class="code_variable">μ_bar_dagger</span><span class="code_operator">)</span>  <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_operator">−</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">ζ_bar_dagger</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">μ_bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">ζ_bar_dagger</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjguate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>M</mo>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>−</mo>
<mo>M</mo>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>0</mo>
</msub>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>t</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</mrow>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>Bx</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>By</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Bz</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Bx</mo>
<mi>,</mi>
<mo>By</mo>
<mi>,</mi>
<mo>Bz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<mo>Hx</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Hy</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<mo>Hx</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Hy</mo>
<mi>,</mi>
<mo>−</mo>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mi>conjguate</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mn>2</mn>
<mo>&#8290;</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mo>ζ_bar_dagger</mo>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>μ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>ζ_bar_dagger</mo>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mrow><mi>conjguate</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>a</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<mover accent="true"><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i39)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3219</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span> <span class="code_operator">[</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_number">2</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_number">3</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span> <span class="code_operator">)</span> <span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>q</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sz</mo>
</mrow>
<mo>N</mo>
</mfrac>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sy</mo>
</mrow>
<mo>N</mo>
</mfrac>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sx</mo>
</mrow>
<mo>N</mo>
</mfrac>
</mrow>
</mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Cannot use 'conjugate for vector operations - must use the verb form instead
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i40)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3220</span><span class="code_operator">:</span><span class="code_operator">[</span>   <span class="code_operator">[</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_number">2</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_number">3</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span> <span class="code_operator">)</span> <span class="code_operator">]</span>  <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sx</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sy</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sz</mo>
</mrow>
<mo>N</mo>
</mfrac>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mfrac><mrow><mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>−</mo>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
<mo>−</mo>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>−</mo>
<mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i41)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3221</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">II</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span>  <span class="code_operator">+</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">I</span><span class="code_operator">[</span><span class="code_variable">M</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">d</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_operator">−</span> <span class="code_variable">ε_bar_dagger</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>q</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>II</mo>
<mo>P</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>+</mo>
<mfrac><mrow><msub><mo>I</mo>
<mo>M</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mo>+</mo>
<mfrac><mrow><msub><mo>I</mo>
<mo>J</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>N</mo>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>q</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>d</mo>
</msub>
<mo>+</mo>
<mfrac><msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>q</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>a</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>q</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ε_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i42)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3222</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">d</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_operator">−</span> <span class="code_variable">ε</span><span class="code_operator">−</span><span class="code_variable">bar_dagger</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
<mo>=</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>d</mo>
</msub>
<mo>+</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>a</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
<mi>,</mi>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ε</mo>
<mo>−</mo>
<mo>bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i43)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3223</span><span class="code_operator">:</span> <span class="code_operator">[</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">σ</span><span class="code_operator">−</span><span class="code_variable">bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">μ_bar</span> <span class="code_operator">−</span> <span class="code_variable">μ_bar_dagger</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>a</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>σ</mo>
<mo>−</mo>
<msub><mo>bar</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>μ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i44)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3224</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">σ</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">ξ_bar</span> <span class="code_operator">−</span> <span class="code_variable">ζ_bar_dagger</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">σ</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ξ_bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">ζ</span><span class="code_operator">−</span><span class="code_variable">bar</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span> <span class="code_variable">ξ_bar</span><span class="code_operator">[</span><span class="code_variable">h</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">ζ_bar</span><span class="code_operator">[</span><span class="code_variable">h</span><span class="code_operator">]</span> <span class="code_operator">)</span> <span class="code_operator">)</span>    <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>σ</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ζ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<msub><mo>σ</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>ζ</mo>
<mo>+</mo>
<msub><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>h</mo>
</msub>
<mo>−</mo>
<msub><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>h</mo>
</msub>
<mo>+</mo>
<msub><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>a</mo>
</msub>
<mo>−</mo>
<msub><mo>bar</mo>
<mo>a</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.2.2 Modal Transmission and Dissipation of Power
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i45)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3225</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">S_i</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">A</span><span class="code_endofline">,</span><span class="code_variable">S_i</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">n</span><span class="code_operator">[</span><span class="code_number">0</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">A</span><span class="code_endofline">,</span> <span class="code_variable">L_i</span><span class="code_operator">)</span>  <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Az</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ay</mo>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mo>Ax</mo>
</mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>S</mo>
<mo>i</mo>
</msub>
<mo>=</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>S</mo>
<mo>i</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ax</mo>
<mi>,</mi>
<mo>Ay</mo>
<mi>,</mi>
<mo>Az</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mo>(</mo><mrow><msub><mo>n</mo>
<mn>0</mn>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ax</mo>
<mi>,</mi>
<mo>Ay</mo>
<mi>,</mi>
<mo>Az</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>L</mo>
<mo>i</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i46)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3226</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span>  <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span>  <span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">i</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>apply: subscript must be an integer; found: </mo>
<mo>P</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo> -- an error. To debug this try: debugmode(true);</mo>
</mtd></mlabeledtr>
</mtable></math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3227</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">E_τ</span> <span class="code_operator">=</span> <span class="code_variable">Z_hat</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span>  <span class="code_endofline">.</span><span class="code_operator">(</span><span class="code_variable">H_τ</span> <span class="code_endofline">~</span> <span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">i</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>τ</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msub><msub><mo>Z</mo>
<mo>hat</mo>
</msub>
<mo>s</mo>
</msub>
<mo> . </mo>
<msub><mo>n</mo>
<mn>1</mn>
</msub>
<mi>~</mi>
<msub><mo>H</mo>
<mo>τ</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3228</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">δ</span><span class="code_operator">=</span><span class="code_function">sqrt</span><span class="code_operator">(</span><span class="code_number">2</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ8σ</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Z_bar</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">+</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">I_bar</span><span class="code_endofline">,</span> <span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">1</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">·</span><span class="code_variable">δ</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">sqrt</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">σ</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>δ</mo>
<mo>=</mo>
<msqrt><mn>2</mn>
</msqrt>
<mo>&#8290;</mo>
<msqrt><mfrac><mn>1</mn>
<mrow><mo>μ8σ</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</msqrt>
<mi>,</mi>
<msub><msub><mo>Z</mo>
<mo>bar</mo>
</msub>
<mo>s</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
</mrow>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mrow><mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
</mrow>
</mtd><mtd><mn>0</mn>
</mtd></mtr><mtr><mtd><mn>0</mn>
</mtd><mtd><mn>0</mn>
</mtd><mtd><mrow><mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
</mrow>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
<mi>,</mi>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
<mo>=</mo>
<mfrac><mn>1</mn>
<mrow><mo>δ</mo>
<mo>&#8290;</mo>
<mo>σ</mo>
</mrow>
</mfrac>
<mi>,</mi>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
<mo>=</mo>
<mfrac><msqrt><mfrac><mrow><mo>μ</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>σ</mo>
</mfrac>
</msqrt>
<msqrt><mn>2</mn>
</msqrt>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3229</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">+</span> <span class="code_variable">Q</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Q</mo>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3230</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">P</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">S</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">P</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mn>1</mn>
<mo>=</mo>
<mrow><mo>&#x222B;</mo><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sx</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sy</mo>
</mrow>
<mo>N</mo>
</mfrac>
<mi>,</mi>
<mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>Sz</mo>
</mrow>
<mo>N</mo>
</mfrac>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mi>,</mi>
<mn>1</mn>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>−</mo>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mi>,</mi>
<mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
<mo>−</mo>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mi>,</mi>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>−</mo>
<mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3231</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Q</span> <span class="code_operator">=</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">Q</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">dta</span><span class="code_operator">(</span><span class="code_variable">q</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">L</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">Q</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_variable">H_τ</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_τ</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>Q</mo>
<mo>=</mo>
<msub><mo>Q</mo>
<mo>s</mo>
</msub>
<mo>+</mo>
<msub><mo>Q</mo>
<mo>b</mo>
</msub>
<mi>,</mi>
<mo>Q</mo>
<mo>=</mo>
<mfrac><mrow><mo>L</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>q</mo>
<mo>s</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mo>+</mo>
<mrow><mo>&#x222B;</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mo>N</mo>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>q</mo>
<mo>b</mo>
</msub>
</mrow>
<mo>N</mo>
</mfrac>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mi>,</mi>
<mo>Q</mo>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>s</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msup><mo>Ez</mo>
<mn>2</mn>
</msup>
<mo>+</mo>
<msup><mo>Ey</mo>
<mn>2</mn>
</msup>
<mo>+</mo>
<msup><mo>Ex</mo>
<mn>2</mn>
</msup>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>τ</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>τ</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>L</mo>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
</mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mrow><mn>1</mn>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mo>Ez</mo>
<mo>&#8290;</mo>
<mo>Hz</mo>
<mo>+</mo>
<mo>Ey</mo>
<mo>&#8290;</mo>
<mo>Hy</mo>
<mo>+</mo>
<mo>Ex</mo>
<mo>&#8290;</mo>
<mo>Hx</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msup><mo>Hz</mo>
<mn>2</mn>
</msup>
<mo>+</mo>
<msup><mo>Hy</mo>
<mn>2</mn>
</msup>
<mo>+</mo>
<msup><mo>Hx</mo>
<mn>2</mn>
</msup>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">declare</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">P</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_variable">j</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">r</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">integer</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3232</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">]</span>   <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>apply: subscript must be an integer; found: </mo>
<mo>g2467</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo> -- an error. To debug this try: debugmode(true);</mo>
</mtd></mlabeledtr>
</mtable></math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3233</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">H</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">H</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span>  <span class="code_endofline">,</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_operator">]</span>   <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>apply: subscript must be an integer; found: </mo>
<mo>g3668</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo> -- an error. To debug this try: debugmode(true);</mo>
</mtd></mlabeledtr>
</mtable></math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3234</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>a</mo>
<mn>1</mn>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<msub><mo>γ</mo>
<mn>1</mn>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mo>&#8290;</mo>
<mrow><mi>Ax</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><mo>a</mo>
<mn>1</mn>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mn>1</mn>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
<mo>−</mo>
<msub><mo>α</mo>
<mn>1</mn>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mo>&#8290;</mo>
<mrow><mi>Ax</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Expansions for the mode contributions to the power flow for the source-free region
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3235</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">P</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">P</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">P</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>apply: found </mo>
<mo>P</mo>
<mo> evaluates to </mo>
<mn>1</mn>
<mo> where </mo>
<mo>a function</mo>
<mo> was expected.
</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo> -- an error. To debug this try: debugmode(true);</mo>
</mtd></mlabeledtr>
</mtable></math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3236</span><span class="code_operator">:</span><span class="code_operator">[</span>  <span class="code_function">Q</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span>  <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar_dagger</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_endofline">,</span><span class="code_variable">S</span> <span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_τ</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H_τ</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">Q</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span> <span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">Q</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>Q</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>τ</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>τ</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>L</mo>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
</mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><mo>σ_bar_dagger</mo>
<mrow><mn>1</mn>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mrow><mn>1</mn>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>4</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hx</mo>
<mi>,</mi>
<mo>Hy</mo>
<mi>,</mi>
<mo>Hz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Ex</mo>
<mi>,</mi>
<mo>Ey</mo>
<mi>,</mi>
<mo>Ez</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
<mi>,</mi>
<mrow><mi>Q</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
<mo>&#8290;</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
</mrow><mn>4</mn>
</mfrac>
<mi>,</mi>
<mrow><mi>Q</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow></mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3237</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mn>1</mn>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3228</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">M_b</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">M_s</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugateE</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">τ</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">τ</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>M</mo>
<mrow><mn>1</mn>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
<mo>=</mo>
<msub><msub><mo>M</mo>
<mo>s</mo>
</msub>
<mrow><mn>1</mn>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
<mo>+</mo>
<msub><msub><mo>M</mo>
<mo>b</mo>
</msub>
<mrow><mn>1</mn>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
<mi>,</mi>
<msub><mo>M</mo>
<mrow><mn>1</mn>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mo>L</mo>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mo>s</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mrow><mo>τ</mo>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mrow><mo>τ</mo>
<mo>,</mo>
<mn>1</mn>
</mrow>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mrow><mo>&#x222B;</mo><mrow><mrow><mi>conjugateE</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mrow><mn>1</mn>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mo>+</mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mrow><mn>1</mn>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>+</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mover accent="true"><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
</mrow>
<mo>&#xaf;</mo></mover>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>+</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mrow><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mn>1</mn>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mn>1</mn>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3239</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>N</mo>
<mrow><mo>l</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mi>,</mi>
<msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>M</mo>
<mrow><mo>l</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3240</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mi>,</mi>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>&#x222B;</mo><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>)</mo></mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3241</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_operator">·</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span> <span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mrow><msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msubsup><mo>A</mo>
<mo>k</mo>
</msubsup>
<mo>&#8290;</mo>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>α</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3242</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_operator">·</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span> <span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>Q</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><mo>Q</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mrow><msub><mo>Q</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msubsup><mo>A</mo>
<mo>k</mo>
</msubsup>
<mo>&#8290;</mo>
<msub><mo>M</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>α</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3243</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">i</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>A</mo>
<mo>l</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
<mo>−</mo>
<msub><mo>γ</mo>
<mo>i</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3244</span><span class="code_operator">:</span> <span class="code_operator">[</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">i</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mn>4</mn>
</mfrac>
<mi>,</mi>
<mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>A</mo>
<mo>l</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
<mo>−</mo>
<msub><mo>γ</mo>
<mo>i</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3245</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mover accent="true"><mrow><msub><mo>P</mo>
<mrow><mo>l</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
<mi>,</mi>
<mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mover accent="true"><mrow><msub><mo>Q</mo>
<mrow><mo>l</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3246</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_operator">)</span>    <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>P</mo>
<mrow><mo>l</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3247</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">Q_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Q_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Q_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_operator">)</span>    <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><msub><mo>Q</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>Q</mo>
<mrow><mo>l</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><msub><mo>Q</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><msub><msub><mo>Q</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
<mo>&#8290;</mo>
<mover accent="true"><mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
NOTE: Condtions for l and z are listed before the double summations where they apply
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3248</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">P</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">l</span> <span class="code_endofline">&lt;</span> <span class="code_variable">k</span> <span class="code_function">or</span> <span class="code_variable">l</span> <span class="code_endofline">&gt;</span> <span class="code_variable">k</span><span class="code_endofline">,</span> <span class="code_function">P</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">l</span><span class="code_endofline">&gt;</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_function">P</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">)</span>   <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>P</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow></mrow><mi>,</mi>
<mo>l</mo>
<mi><</mi>
<mo>k</mo>
<mo> ⋁ </mo>
<mo>l</mo>
<mi>></mi>
<mo>k</mo>
<mi>,</mi>
<mrow><mi>P</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow></mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow><mi>,</mi>
<mo>l</mo>
<mi>></mi>
<mo>k</mo>
<mi>,</mi>
<mrow><mi>P</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
<mo>&#8290;</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
</mrow><mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow><mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3249</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">Q</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">l</span> <span class="code_endofline">&lt;</span> <span class="code_variable">k</span> <span class="code_function">or</span> <span class="code_variable">l</span> <span class="code_endofline">&gt;</span> <span class="code_variable">k</span><span class="code_endofline">,</span> <span class="code_function">Q</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">Q_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">l</span><span class="code_endofline">&gt;</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_function">Q</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">)</span>   <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>Q</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow></mrow><mi>,</mi>
<mo>l</mo>
<mi><</mi>
<mo>k</mo>
<mo> ⋁ </mo>
<mo>l</mo>
<mi>></mi>
<mo>k</mo>
<mi>,</mi>
<mrow><mi>Q</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><msub><mo>Q</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow></mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>Q</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow><mi>,</mi>
<mo>l</mo>
<mi>></mi>
<mo>k</mo>
<mi>,</mi>
<mrow><mi>Q</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mfrac><mrow><mi>Re</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mover accent="true"><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>&#xaf;</mo></mover>
<mo>&#8290;</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>l</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
</mrow><mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>M</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow><mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.3 Quasi-Orthogonality and Orthogonality of Modes in Lossy and Lossless Bianisotropic Active Media Waveguides<br/><br/>3.3.1 Mode Quasi-Orthogonality Relations for Lossy Waveguides<br/><br/>NOTE: NEED A SHORTER NAMING CONVENTION FOR BAR, HAT AND DAGGER ACCENTSf
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_331</span><span class="code_operator">:</span> <span class="code_operator">[</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">cur</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ζ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>express</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mi>cur</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_332</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>express</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mi>curl</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
NOTE: Using 2D Divergence Theorem on the left-hand side of (3.3.3)
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_333</span><span class="code_operator">:</span> <span class="code_operator">[</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Ek</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">Hl</span> <span class="code_operator">+</span> <span class="code_variable">El</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Hk</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Ek</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">El</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Hk</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">Hl</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Ek</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">Hl</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">Hk</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar_dagger</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">El</span> <span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>   </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>Eky</mo>
<mo>&#8290;</mo>
<mo>Hlz</mo>
<mo>−</mo>
<mo>Ekz</mo>
<mo>&#8290;</mo>
<mo>Hly</mo>
<mo>+</mo>
<mo>Ely</mo>
<mo>&#8290;</mo>
<mo>Hkz</mo>
<mo>−</mo>
<mo>Elz</mo>
<mo>&#8290;</mo>
<mo>Hky</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>−</mo>
<mo>Ekx</mo>
<mo>&#8290;</mo>
<mo>Hlz</mo>
<mo>+</mo>
<mo>Ekz</mo>
<mo>&#8290;</mo>
<mo>Hlx</mo>
<mo>−</mo>
<mo>Elx</mo>
<mo>&#8290;</mo>
<mo>Hkz</mo>
<mo>+</mo>
<mo>Elz</mo>
<mo>&#8290;</mo>
<mo>Hkx</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>Ekx</mo>
<mo>&#8290;</mo>
<mo>Hly</mo>
<mo>−</mo>
<mo>Eky</mo>
<mo>&#8290;</mo>
<mo>Hlx</mo>
<mo>+</mo>
<mo>Elx</mo>
<mo>&#8290;</mo>
<mo>Hky</mo>
<mo>−</mo>
<mo>Ely</mo>
<mo>&#8290;</mo>
<mo>Hkx</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mrow><mo>[</mo><mrow><mo>Hkx</mo>
<mi>,</mi>
<mo>Hky</mo>
<mi>,</mi>
<mo>Hkz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><mo>σ_bar_dagger</mo>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Elx</mo>
<mi>,</mi>
<mo>Ely</mo>
<mi>,</mi>
<mo>Elz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>−</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><mo>Hkx</mo>
<mi>,</mi>
<mo>Hky</mo>
<mi>,</mi>
<mo>Hkz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>m</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hlx</mo>
<mi>,</mi>
<mo>Hly</mo>
<mi>,</mi>
<mo>Hlz</mo>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><mo>Ekx</mo>
<mi>,</mi>
<mo>Eky</mo>
<mi>,</mi>
<mo>Ekz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Elx</mo>
<mi>,</mi>
<mo>Ely</mo>
<mi>,</mi>
<mo>Elz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><mo>Ekx</mo>
<mi>,</mi>
<mo>Eky</mo>
<mi>,</mi>
<mo>Ekz</mo>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><mo>Hlx</mo>
<mi>,</mi>
<mo>Hly</mo>
<mi>,</mi>
<mo>Hlz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_endofline">,</span> <span class="code_variable">H</span><span class="code_endofline">,</span> <span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">E_hat</span><span class="code_endofline">,</span> <span class="code_variable">H_hat</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_334</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span>  <span class="code_operator">=</span>  <span class="code_operator">−</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_function">conjguate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">σ_bar_dagger</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">R</span><span class="code_operator">[</span><span class="code_variable">S</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">τ</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">τ</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">L</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mn>0</mn>
<mi>,</mi>
<mn>0</mn>
<mi>,</mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mo>−</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mo>L</mo>
<mo>&#8290;</mo>
<msub><mo>R</mo>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mrow><mo>τ</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mrow><mo>τ</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>−</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mrow><mrow><mi>conjguate</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>e</mo>
</msub>
<mo> . </mo>
<msub><mo>E</mo>
<mo>l</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>−</mo>
<mrow><mo>&#x222B;</mo><mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><mo>σ_bar_dagger</mo>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><mo>E</mo>
<mo>l</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>l</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>−</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>m</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>l</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_335</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mrow><mo>[</mo><mrow><mo>E</mo>
<mi>,</mi>
<mo>simp</mo>
<mi>,</mi>
<mo>array</mo>
</mrow>
<mo>]</mo></mrow>
<mo>l</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<msub><mo>γ</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mi>,</mi>
<mrow><msub><mo>H</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<msub><mo>γ</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_336</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>γ</mo>
<mo>l</mo>
</msub>
<mo>−</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mo>=</mo>
<mo>−</mo>
<msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>γ</mo>
<mo>l</mo>
</msub>
<mo>−</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_337</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>γ</mo>
<mo>l</mo>
</msub>
<mo>+</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<msub><mo>M</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_338</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>γ</mo>
<mo>l</mo>
</msub>
<mo>+</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_339</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>Q</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_339_B</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">Q</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">M</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">/</span> <span class="code_operator">(</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mfrac><msub><mo>Q</mo>
<mo>k</mo>
</msub>
<mrow><mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>P</mo>
<mo>k</mo>
</msub>
</mrow>
</mfrac>
<mi>,</mi>
<msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mfrac><msub><mo>M</mo>
<mo>k</mo>
</msub>
<mrow><mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.3.2 Mode Orthogonality Relations For Lossless Waveguides
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3310</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>γ</mo>
<mo>l</mo>
</msub>
<mo>+</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3311</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span> <span class="code_variable">α</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>γ</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
<mi>,</mi>
<msub><mo>α</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msub><mo>α</mo>
<mo>k</mo>
</msub>
<mi>,</mi>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3312</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span> <span class="code_operator">·</span> <span class="code_variable">γ_bar</span><span class="code_endofline">,</span> <span class="code_variable">k_bar</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">k</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">%i</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">γ_bar</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">γ</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>k</mo>
<mo>bar</mo>
</msub>
<mo>z</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>γ</mo>
<mo>bar</mo>
</msub>
<mi>,</mi>
<msub><msub><mo>k</mo>
<mo>bar</mo>
</msub>
<mo>z</mo>
</msub>
<mo>=</mo>
<msub><mo>k</mo>
<mo>z</mo>
</msub>
<mi>,</mi>
<msub><msub><mo>k</mo>
<mo>bar</mo>
</msub>
<mo>z</mo>
</msub>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>γ</mo>
<mi>,</mi>
<msub><mo>γ</mo>
<mo>bar</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<mo>γ</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.3.2.1 Orthogonality and Normalization Relations For Active Modes
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3315</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">(</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span>  <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>−</mo>
<msub><mo>β</mo>
<mo>l</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_endofline">,</span> <span class="code_variable">H_hat</span><span class="code_endofline">,</span> <span class="code_variable">E_hat</span><span class="code_endofline">,</span><span class="code_variable">A</span> <span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3314</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">express</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>~ used with improper arguments: </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo> </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>#0: express1(expn=H_hat[k] ~ E_hat[l]) (vect.mac line 191)
</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>#1: express1(expn=-H_hat[k] ~ E_hat[l])
</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo> -- an error. To debug this try: debugmode(true);</mo>
</mtd></mlabeledtr>
</mtable></math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3315</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">#</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span> <span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span>  <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mi>≠</mi>
<mn>0</mn>
<mi>,</mi>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mi>,</mi>
<msub><mo>N</mo>
<mo>l</mo>
</msub>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3316</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msubsup><mo>a</mo>
<mo>k</mo>
</msubsup>
<mi>,</mi>
<msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msubsup><mo>a</mo>
<mo>k</mo>
</msubsup>
<mi>,</mi>
<msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msubsup><mo>A</mo>
<mo>k</mo>
</msubsup>
<mi>,</mi>
<msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msubsup><mo>A</mo>
<mo>k</mo>
</msubsup>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3317</span><span class="code_operator">:</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_operator">−</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><msub><mo>N</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msub><mo>N</mo>
<mrow><mo>−</mo>
<mo>m</mo>
</mrow>
</msub>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3318</span><span class="code_operator">:</span> <span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">δ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">if</span> <span class="code_variable">l</span> <span class="code_endofline">&lt;</span> <span class="code_variable">k</span> <span class="code_function">or</span> <span class="code_variable">l</span> <span class="code_endofline">&gt;</span> <span class="code_variable">k</span> <span class="code_function">then</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_function">if</span> <span class="code_variable">l</span> <span class="code_operator">=</span> <span class="code_variable">k</span> <span class="code_function">then</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>δ</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mi>,</mi>
<mi>if</mi>
<mi> </mi>
<mo>l</mo>
<mi><</mi>
<mo>k</mo>
<mo> ⋁ </mo>
<mo>l</mo>
<mi>></mi>
<mo>k</mo>
<mi> </mi>
<mi>then</mi>
<mi> </mi>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<mn>0</mn>
<mi> </mi>
<mi>,</mi>
<mo>false</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Orthogonality and Normalization Relations for Reactive Modes
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">declare</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_variable">j</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">integer</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3319</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjguate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_endofline">,</span>  <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<mrow><mo>&#x222B;</mo><mrow><mrow><mo>(</mo><mrow><mrow><mi>conjguate</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mi>~</mi>
<msub><mo>H</mo>
<mo>l</mo>
</msub>
<mo>−</mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mi>,</mi>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3320</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">#</span> <span class="code_number">0</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>=</mo>
<mrow><mo>&#x222B;</mo><mrow><mrow><mo>(</mo><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
<mo>−</mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mi>,</mi>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mi>≠</mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3321</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_function">or</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mo>false</mo>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3322</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mover accent="true"><msub><mo>N</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3323</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_endofline">,</span> <span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span>  <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mo>+</mo>
<msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mi>,</mi>
<msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mo>=</mo>
<mn>2</mn>
<mo>&#8290;</mo>
<msub><mo>P</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mi>,</mi>
<msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mo>=</mo>
<mfrac><mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>A</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
</mrow>
<mn>2</mn>
</mfrac>
<mi>,</mi>
<msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mo>=</mo>
<mfrac><mrow><msubsup><mo>A</mo>
<mo>k</mo>
</msubsup>
<mo>&#8290;</mo>
<msub><mo>N</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3324</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">δ</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_function">if</span> <span class="code_variable">l</span> <span class="code_endofline">&lt;</span> <span class="code_variable">k</span> <span class="code_function">or</span> <span class="code_variable">l</span> <span class="code_endofline">&gt;</span> <span class="code_variable">k</span> <span class="code_function">then</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_function">if</span> <span class="code_variable">l</span> <span class="code_operator">=</span> <span class="code_variable">k</span> <span class="code_function">then</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">−</span><span class="code_variable">bar</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>δ</mo>
<mrow><msub><mo>k</mo>
<mo>bar</mo>
</msub>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mi>,</mi>
<mi>if</mi>
<mi> </mi>
<mo>l</mo>
<mi><</mi>
<mo>k</mo>
<mo> ⋁ </mo>
<mo>l</mo>
<mi>></mi>
<mo>k</mo>
<mi> </mi>
<mi>then</mi>
<mi> </mi>
<msub><mo>N</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mo>l</mo>
</mrow>
</msub>
<mo>=</mo>
<mn>0</mn>
<mi> </mi>
<mi>,</mi>
<mo>false</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3325</span><span class="code_operator">:</span> <span class="code_operator">[</span> <span class="code_variable">P</span> <span class="code_operator">=</span> <span class="code_variable">P_act</span> <span class="code_operator">+</span> <span class="code_variable">P_react</span><span class="code_endofline">,</span> <span class="code_variable">P</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">P_pair</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">k_bar</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">P</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">abs</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">^</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">n</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k_bar</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span> <span class="code_operator">)</span><span class="code_operator">)</span>    <span class="code_operator">]</span>  <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>P</mo>
<mo>=</mo>
<msub><mo>P</mo>
<mo>react</mo>
</msub>
<mo>+</mo>
<msub><mo>P</mo>
<mo>act</mo>
</msub>
<mi>,</mi>
<mo>P</mo>
<mo>=</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><msub><msub><mo>P</mo>
<mo>pair</mo>
</msub>
<mrow><mo>k</mo>
<mo>,</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</mrow>
</msub>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><msub><mo>P</mo>
<mo>k</mo>
</msub>
</mrow><mi>,</mi>
<mo>P</mo>
<mo>=</mo>
<mfrac><mrow><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>a</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>a</mo>
<msub><mo>k</mo>
<mo>bar</mo>
</msub>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mi>imagpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
<mn>2</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>n</mo>
</munderover><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow><mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.3.3 Time-Average Stored Energy For Active Modes In Lossless Media<br/><br/>TODO: The kill(E,H) command is temporary - define indices i,j,k as integers and initialize once all field vectors have harmonic vector-valued functions
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">H</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_variable">j</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_variable">a</span><span class="code_endofline">,</span><span class="code_variable">b</span> <span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3325_A</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ζ_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">σ_bar</span><span class="code_operator">[</span><span class="code_variable">c</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>δE</mo>
<mo>k</mo>
</msub>
<mi>,</mi>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
<mi>,</mi>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<msub><msub><mo>σ</mo>
<mo>bar</mo>
</msub>
<mo>c</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
TODO: Change δE[k] and δH[k] to vectors and enclose curl() in express()
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3326</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ζ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ζ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">]</span>     <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>curl</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>δE</mo>
<mo>k</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>δE</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3327</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span> <span class="code_endofline">.</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>curl</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>δH</mo>
<mo>k</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>δE</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3327_B</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">div</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_operator">−</span> <span class="code_variable">ε_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">μ_bar</span> <span class="code_operator">−</span> <span class="code_variable">μ_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_operator">+</span>  <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">ξ_bar</span> <span class="code_operator">−</span> <span class="code_variable">ζ_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">ζ_bar</span> <span class="code_operator">−</span> <span class="code_variable">ξ_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span>  <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">.</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ζ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mn>2</mn>
<mo>&#8290;</mo>
<mrow><mi>div</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ξ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>δE</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>μ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ζ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ε_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>δE</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3328</span><span class="code_operator">:</span> <span class="code_operator">[</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span><span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">)</span>    <span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>div</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
<mo>−</mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>δE</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mn>2</mn>
<mo>&#8290;</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3329</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">δE</span><span class="code_operator">[</span><span class="code_variable">jk</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">δE_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">δβ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">·</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mi>,</mi>
<msub><mo>δE</mo>
<mo>jk</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><msub><mo>δE_hat</mo>
<mo>k</mo>
</msub>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>δβ</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3330</span><span class="code_operator">:</span> <span class="code_operator">[</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">δH</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">δH_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">·</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mi>,</mi>
<msub><mo>δH</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mrow><mo>(</mo><mrow><msub><mo>δH_hat</mo>
<mo>k</mo>
</msub>
<mo>−</mo>
<mo>i</mo>
<mo>&#8290;</mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3331</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">δβ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_number">2</span> <span class="code_operator">·</span> <span class="code_function">Re</span><span class="code_operator">(</span> <span class="code_function">δ</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mfrac><mrow><msub><mo>δβ</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>&#x222B;</mo><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow></mrow>
<mn>2</mn>
</mfrac>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mn>2</mn>
<mo>&#8290;</mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<mrow><mi>δ</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3332</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">v</span><span class="code_operator">[</span><span class="code_variable">gr</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">1</span><span class="code_operator">/</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">P</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">v</span><span class="code_operator">[</span><span class="code_variable">gr</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">W</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>v</mo>
<mrow><mo>gr</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>=</mo>
<mfrac><mn>1</mn>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>ω</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow>
</mfrac>
<mi>,</mi>
<msub><mo>P</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<msub><mo>v</mo>
<mrow><mo>gr</mo>
<mo>,</mo>
<mo>k</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>W</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3333</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">W</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_operator">+</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span>  <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">Re</span><span class="code_operator">(</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span>  <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ</span><span class="code_operator">−</span><span class="code_variable">bar</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>W</mo>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mo>H</mo>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo> . </mo>
<mo>H</mo>
<mo>+</mo>
<mo>E</mo>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo> . </mo>
<mo>E</mo>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>4</mn>
</mfrac>
<mo>+</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mi>realpart</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>E</mo>
<mo> . </mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>ξ</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<mo>bar</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo> . </mo>
<mo>H</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mn>2</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3334</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">w</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_number">4</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_operator">(</span> <span class="code_function">matrix</span><span class="code_operator">(</span><span class="code_operator">[</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ξ_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_operator">[</span>  <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ζ_bar</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">ω</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_bar</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_function">matrix</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">H</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>w</mo>
<mo>=</mo>
<mfrac><mrow><mover accent="true"><mo>E</mo>
<mo>&#xaf;</mo></mover>
<mo>&#8290;</mo>
<mover accent="true"><mo>H</mo>
<mo>&#xaf;</mo></mover>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><mo>H</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mo>E</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mtd></mtr><mtr><mtd><mrow><mo>H</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mo>E</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mtd></mtr></mtable>
</mrow><mo>)</mo></mrow>
</mrow>
<mn>4</mn>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.4     Orthogonal Complementary Fields and Effective Surfacae Currents<br/>Inside the Source Region      <br/><br/>3.4.1 Bulk and Surface Exciting Currents
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_341</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">ΔD</span> <span class="code_operator">=</span> <span class="code_variable">Δε_bar</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_operator">+</span> <span class="code_variable">E_ext</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">Δξ_bar</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">H_ext</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">ΔB</span> <span class="code_operator">=</span> <span class="code_variable">Δζ_bar</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">E</span> <span class="code_operator">+</span> <span class="code_variable">E_ext</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">Δμ_bar</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">H_ext</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>ΔD</mo>
<mo>=</mo>
<mo>Δξ_bar</mo>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>ext</mo>
</msub>
<mo>+</mo>
<mo>H</mo>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mo>Δε_bar</mo>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>ext</mo>
</msub>
<mo>+</mo>
<mo>E</mo>
</mrow>
<mo>)</mo></mrow>
<mi>,</mi>
<mo>ΔB</mo>
<mo>=</mo>
<mo>Δμ_bar</mo>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>ext</mo>
</msub>
<mo>+</mo>
<mo>H</mo>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mo>Δζ_bar</mo>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>ext</mo>
</msub>
<mo>+</mo>
<mo>E</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_343</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_endofline">,</span><span class="code_variable">ext</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_endofline">,</span><span class="code_variable">ind</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_endofline">,</span><span class="code_variable">ext</span><span class="code_operator">]</span>  <span class="code_operator">+</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ΔD</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>J</mo>
<mrow><mo>e</mo>
<mo>,</mo>
<mo>ext</mo>
</mrow>
</msub>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>e</mo>
<mo>,</mo>
<mo>ind</mo>
</mrow>
</msub>
<mi>,</mi>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>ΔD</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>e</mo>
<mo>,</mo>
<mo>ext</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_344</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">ext</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">ind</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">ext</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ΔB</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>J</mo>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>ext</mo>
</mrow>
</msub>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>ind</mo>
</mrow>
</msub>
<mi>,</mi>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>ΔB</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>ext</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_345</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">B</span> <span class="code_operator">−</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>curl</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>E</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Bx</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mi>,</mi>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>By</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mi>,</mi>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Bz</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_346</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">D</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>curl</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>H</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mo>Dx</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Dy</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<mo>Dz</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_347</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">n</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">n</span><span class="code_operator">]</span>  <span class="code_operator">=</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<msub><mo>E</mo>
<mo>p</mo>
</msub>
<mi>~</mi>
<msub><mo>n</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>p</mo>
</mrow>
</msub>
<mo>−</mo>
<msub><mo>E</mo>
<mo>n</mo>
</msub>
<mi>~</mi>
<msub><mo>n</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>n</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_348</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">n</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">n</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<msub><mo>H</mo>
<mo>p</mo>
</msub>
<mi>~</mi>
<msub><mo>n</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>p</mo>
</mrow>
</msub>
<mo>−</mo>
<msub><mo>H</mo>
<mo>n</mo>
</msub>
<mi>~</mi>
<msub><mo>n</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>n</mo>
</mrow>
</msub>
<mo>=</mo>
<msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.4.2 Orthogonal Complementary Fields and Effective Surface Currents
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_349</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>E</mo>
<mo>a</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3410</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">H</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">H</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>H</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>H</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>H</mo>
<mo>a</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>H</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>H</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_endofline">,</span> <span class="code_variable">D_hat</span><span class="code_endofline">,</span> <span class="code_variable">B</span><span class="code_endofline">,</span> <span class="code_variable">B_hat</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3411</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">D</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">D</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">j</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">D_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>D</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>D</mo>
<mo>a</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>D</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><msub><mo>D</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>j</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3412</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">B</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">B</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">B_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>B</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>B</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>B</mo>
<mo>a</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>B</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><msub><mo>B</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>B</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow></mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i56)	
  </span></td>
  <td><span class="input">
<span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Ek_x</span><span class="code_endofline">,</span> <span class="code_variable">Ek_y</span><span class="code_endofline">,</span> <span class="code_variable">Ek_z</span><span class="code_operator">]</span><span class="code_endofline">;</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Hk_x</span><span class="code_endofline">,</span> <span class="code_variable">Hk_y</span><span class="code_endofline">,</span> <span class="code_variable">Hk_z</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Bk_x</span><span class="code_endofline">,</span><span class="code_variable">Bk_y</span><span class="code_endofline">,</span> <span class="code_variable">Bk_z</span><span class="code_operator">]</span> <span class="code_endofline">;</span><span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Dk_x</span><span class="code_endofline">,</span> <span class="code_variable">Dk_y</span><span class="code_endofline">,</span> <span class="code_variable">Dk_z</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Ak_x</span><span class="code_endofline">,</span> <span class="code_variable">Ak_y</span><span class="code_endofline">,</span> <span class="code_variable">Ak_z</span><span class="code_operator">]</span><span class="code_endofline">;</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">Hb_x</span><span class="code_endofline">,</span> <span class="code_variable">Hb_y</span><span class="code_endofline">,</span> <span class="code_variable">Hb_z</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>
<mlabeledtr columnalign="left"><mtd><mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo>assignment: matrix row index must be an integer; found: </mo>
<mo>k</mo>
</mtd></mlabeledtr>
<mlabeledtr columnalign="left"><mtd><mtext></mtext></mtd><mtd><mo> -- an error. To debug this try: debugmode(true);</mo>
</mtd></mlabeledtr>
</mtable></math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3413</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>Bk</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>Bk</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>Bk</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3414</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>Dk</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>Dk</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>Dk</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3415</span><span class="code_operator">:</span><span class="code_operator">'</span><span class="code_operator">[</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">'</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>B</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<mrow><mi>express</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mi>curl</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3416</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span><span class="code_operator">=</span><span class="code_operator">−</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>=</mo>
<mrow><mo>[</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hb</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hb</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3417</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>B</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>−</mo>
<mrow><mi>div</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3418</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>div</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3419</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>&#x222B;</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>=</mo>
<mrow><mo>&#x222B;</mo><mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mi>,</mi>
<mrow><mo>&#x222B;</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>−</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo> . </mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><mo>=</mo>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3420</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
<mi>,</mi>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3421</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo>=</mo>
<mn>0</mn>
<mi>,</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3422</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">ε</span><span class="code_operator">−</span><span class="code_variable">zz</span> <span class="code_operator">·</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">ξ_zz</span> <span class="code_operator">·</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">j</span><span class="code_operator">[</span><span class="code_variable">B</span><span class="code_endofline">,</span><span class="code_variable">Z</span><span class="code_endofline">,</span><span class="code_variable">E</span><span class="code_operator">]</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ξ</mo>
<mo>zz</mo>
</msub>
<mo>+</mo>
<mo>ε</mo>
<mo>−</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>zz</mo>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ξ</mo>
<mo>zz</mo>
</msub>
<mo>+</mo>
<mo>ε</mo>
<mo>−</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>zz</mo>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ξ</mo>
<mo>zz</mo>
</msub>
<mo>+</mo>
<mo>ε</mo>
<mo>−</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mo>zz</mo>
</mrow>
<mo>]</mo></mrow>
<mi>,</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>D</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>j</mo>
<mrow><mo>B</mo>
<mo>,</mo>
<mo>Z</mo>
<mo>,</mo>
<mo>E</mo>
</mrow>
</msub>
</mrow>
<mo>ω</mo>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3423</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">ζ_zz</span> <span class="code_operator">·</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">μ_zz</span> <span class="code_operator">·</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>B</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ζ</mo>
<mo>zz</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ζ</mo>
<mo>zz</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ζ</mo>
<mo>zz</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>,</mi>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>B</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
</mrow>
<mo>ω</mo>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3424</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_zz</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">−</span><span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mrow><mo>(</mo><mrow><mn>1</mn>
<mo>−</mo>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>ε</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3425</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_zz</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">−</span><span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><mrow><mo>(</mo><mrow><mn>1</mn>
<mo>−</mo>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3426</span><span class="code_operator">:</span> <span class="code_operator">[</span><span class="code_variable">ν_e</span><span class="code_operator">=</span><span class="code_variable">ζ_zz</span><span class="code_operator">/</span><span class="code_variable">ε_zz</span><span class="code_endofline">,</span> <span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">ζ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">)</span> <span class="code_operator">/</span> <span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">ν_m</span> <span class="code_operator">=</span> <span class="code_variable">ξ_zz</span><span class="code_operator">/</span><span class="code_variable">μ_zz</span><span class="code_endofline">,</span> <span class="code_variable">ν_m</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_variable">ξ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">)</span> <span class="code_operator">/</span> <span class="code_operator">(</span><span class="code_variable">μ_bar</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>ν</mo>
<mo>e</mo>
</msub>
<mo>=</mo>
<mfrac><msub><mo>ζ</mo>
<mo>zz</mo>
</msub>
<msub><mo>ε</mo>
<mo>zz</mo>
</msub>
</mfrac>
<mi>,</mi>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
</mfrac>
<mi>,</mi>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mfrac><msub><mo>ξ</mo>
<mo>zz</mo>
</msub>
<msub><mo>μ</mo>
<mo>zz</mo>
</msub>
</mfrac>
<mi>,</mi>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3427</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">if</span> <span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span> <span class="code_endofline">&lt;</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_function">then</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_function">and</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">E_minus</span> <span class="code_endofline">,</span> <span class="code_function">if</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">&gt;</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_function">then</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_function">and</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">E_plus</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mi>if</mi>
<mi> </mi>
<msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi><</mi>
<msub><mo>L</mo>
<mo>b</mo>
</msub>
<mi> </mi>
<mi>then</mi>
<mi> </mi>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo> ⋀ </mo>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<msub><mo>E</mo>
<mo>minus</mo>
</msub>
<mi> </mi>
<mi>,</mi>
<mi>if</mi>
<mi> </mi>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>></mi>
<msub><mo>L</mo>
<mo>b</mo>
</msub>
<mi> </mi>
<mi>then</mi>
<mi> </mi>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo> ⋀ </mo>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<msub><mo>E</mo>
<mo>plus</mo>
</msub>
<mi> </mi>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3428</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">n_b</span><span class="code_operator">[</span><span class="code_variable">plus</span><span class="code_operator">]</span>  <span class="code_endofline">~</span> <span class="code_variable">E_plus</span> <span class="code_operator">+</span> <span class="code_variable">n_b</span><span class="code_operator">[</span><span class="code_variable">minus</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E_minus</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline"><br/>
</span>    <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<msub><mo>E</mo>
<mo>plus</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>n</mo>
<mo>b</mo>
</msub>
<mo>plus</mo>
</msub>
<mo>−</mo>
<msub><mo>E</mo>
<mo>minus</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>n</mo>
<mo>b</mo>
</msub>
<mo>minus</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>n</mo>
<mo>b</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
n_plus[b] and n_minus[b] are the inward unit vectors for two adjacent media<br/>normal to the contour line L[b] where L[b] is the boundary of a transverse surface<br/>(plane) perpendicular to Z, a surface denoted as S or S[b]<br/>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3429</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">n_plus</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H_plus</span> <span class="code_operator">+</span> <span class="code_variable">n_minus</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span>  <span class="code_endofline">~</span> <span class="code_variable">H_minus</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>−</mo>
<msub><mo>H</mo>
<mo>plus</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>n</mo>
<mo>plus</mo>
</msub>
<mo>b</mo>
</msub>
<mo>−</mo>
<msub><mo>H</mo>
<mo>minus</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>n</mo>
<mo>minus</mo>
</msub>
<mo>b</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>n</mo>
<mo>b</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
Evaluated at L[b] - how to use maxima's at or atvalue to display this?
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3430</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">,</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">τ</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">ν_e</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">/</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_zz</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">−</span><span class="code_variable">ν_e</span><span class="code_operator">·</span><span class="code_variable">ν_m</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mo>e</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>n</mo>
<mo>b</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mi>,</mi>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mo>e</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>τ</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mn>1</mn>
<mo>−</mo>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3431</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_variable">n</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span>  <span class="code_operator">=</span> <span class="code_variable">τ</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">ν</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">/</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_zz</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">−</span><span class="code_variable">ν_e</span><span class="code_operator">·</span><span class="code_variable">ν_m</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><mo>n</mo>
<mo>b</mo>
</msub>
<mi>,</mi>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>τ</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>−</mo>
<mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mrow><msub><mo>ε</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mn>1</mn>
<mo>−</mo>
<msub><mo>ν</mo>
<mo>e</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>ν</mo>
<mo>m</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3423</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span>  <span class="code_operator">=</span><span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span> <span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>ε</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mi>,</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>μ</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3433</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">τ</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">/</span> <span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span><span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">τ</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>=</mo>
<mo>−</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>τ</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mrow><mo>ε</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mi>,</mi>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>τ</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mrow><mo>μ</mo>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3434</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_zz</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_zz</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><msub><mo>ε</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mi>,</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hb</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hb</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#8290;</mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3435</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">τ</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">ε_zz</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span>  <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_operator">(</span><span class="code_variable">τ</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">/</span><span class="code_operator">(</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_variable">μ_zz</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>=</mo>
<mo>−</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>τ</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mrow><msub><mo>ε</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
<mi>,</mi>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>τ</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>z</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mrow><msub><mo>μ</mo>
<mo>zz</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
3.5 Equations of Mode Excitation by Given Exciting Currents<br/><br/>3.5.1 Approach to lossless systems based on the electrodynamic method of variation of constants
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_351</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">f</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">k</span> <span class="code_endofline">&gt;</span> <span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mrow><mo>[</mo><mrow><msub><mo>Ak</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>f</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mo>k</mo>
<mi>></mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i1)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_352</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">A_0</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">f</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">0</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">ΔA</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>&#x222B;</mo><mrow><msub><mo>f</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mrow><mo>d</mo>
<mo>z</mo>
</mrow>
</mrow><mo>+</mo>
<msub><msub><mo>A</mo>
<mo>0</mo>
</msub>
<mo>k</mo>
</msub>
<mi>,</mi>
<mrow><msub><mo>A</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><msub><mo>ΔA</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
<mo>+</mo>
<msub><mo>A</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mn>0</mn>
</mrow>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_353</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_operator">+</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_number">0</span><span class="code_operator">)</span> <span class="code_endofline">&gt;</span> <span class="code_number">0</span> <span class="code_function">or</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">p</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_number">0</span><span class="code_operator">)</span> <span class="code_endofline">&lt;</span><span class="code_number">0</span> <span class="code_function">or</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_operator">+</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_number">0</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span>  <span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>A</mo>
<mo>m</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mn>0</mn>
<mo>)</mo></mrow>
</mrow>
<mi>></mi>
<mn>0</mn>
<mo> ⋁ </mo>
<mrow><msub><mo>A</mo>
<mrow><mo>p</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mn>0</mn>
<mo>)</mo></mrow>
</mrow>
<mi><</mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_354</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_operator">−</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">)</span> <span class="code_endofline">&lt;</span> <span class="code_number">0</span> <span class="code_function">or</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_operator">−</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">)</span> <span class="code_endofline">&gt;</span> <span class="code_number">0</span> <span class="code_function">or</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_operator">−</span><span class="code_variable">m</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">L</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_number">0</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><msub><mo>A</mo>
<mrow><mo>−</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>L</mo>
<mo>)</mo></mrow>
</mrow>
<mi><</mi>
<mn>0</mn>
<mo> ⋁ </mo>
<mrow><msub><mo>A</mo>
<mrow><mo>−</mo>
<mo>m</mo>
</mrow>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>L</mo>
<mo>)</mo></mrow>
</mrow>
<mi>></mi>
<mn>0</mn>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_354_A</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">0</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">ΔA</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">E</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">E_gen</span> <span class="code_operator">+</span> <span class="code_variable">E_part</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>ΔA</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>A</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mn>0</mn>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>E</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>E</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<msub><mo>E</mo>
<mo>part</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>gen</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_354_B</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_function">H</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">0</span><span class="code_operator">]</span> <span class="code_operator">·</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">ΔA</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_function">H</span><span class="code_operator">(</span><span class="code_variable">r</span><span class="code_operator">[</span><span class="code_variable">t</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">H_gen</span> <span class="code_operator">+</span> <span class="code_variable">H_part</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mi>H</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>&#8290;</mo>
<mrow><msub><mo>ΔA</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mo>z</mo>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>A</mo>
<mrow><mo>k</mo>
<mo>,</mo>
<mn>0</mn>
</mrow>
</msub>
<mo>&#8290;</mo>
<mrow><msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mrow><msub><mo>H</mo>
<mo>b</mo>
</msub>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mi>,</mi>
<mrow><mi>H</mi>
<mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mo>r</mo>
<mo>t</mo>
</msub>
<mi>,</mi>
<mo>z</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>=</mo>
<msub><mo>H</mo>
<mo>part</mo>
</msub>
<mo>+</mo>
<msub><mo>H</mo>
<mo>gen</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_355</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_function">sum</span><span class="code_operator">(</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_operator">+</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span>  <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">k</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_endofline">,</span><span class="code_variable">N</span><span class="code_operator">)</span>  <span class="code_operator">+</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span> <span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">+</span> <span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">l</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span> <span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mo>E</mo>
<mi>~</mi>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
<mo>−</mo>
<mo>H</mo>
<mi>~</mi>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>S</mo>
<mo>=</mo>
<mo>S</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><munderover><mo>&#x2211;</mo><mrow><mo>k</mo>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mo>N</mo>
</munderover><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
<mo>−</mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow><mo>)</mo></mrow>
<mo>+</mo>
<mo>S</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
<mo>−</mo>
<msub><mo>H</mo>
<mo>b</mo>
</msub>
<mi>~</mi>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>l</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_endofline">,</span> <span class="code_variable">H_hat</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_356</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span>  <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">=</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">β</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">S</span> <span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>(</mo><mrow><mo>E</mo>
<mi>~</mi>
<mover accent="true"><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
<mo>−</mo>
<mo>H</mo>
<mi>~</mi>
<mover accent="true"><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
<mi>,</mi>
<msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mrow><mo>[</mo><mrow><msub><mo>Ak</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msup><mo>%e</mo>
<mrow><mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>β</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</msup>
</mrow>
<mo>]</mo></mrow>
<mi>,</mi>
<mrow><mo>[</mo><mrow><msub><mo>Ak</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mi>~</mi>
<mo>H</mo>
<mo>+</mo>
<mo>E</mo>
<mi>~</mi>
<mover accent="true"><mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_357</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>(</mo><mrow><mo>E</mo>
<mi>~</mi>
<mover accent="true"><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
<mo>−</mo>
<mo>H</mo>
<mi>~</mi>
<mover accent="true"><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
<mi>,</mi>
<mrow><mo>[</mo><mrow><msub><mo>Ak</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ak</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mfrac><mrow><mo>&#x222B;</mo><mrow><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
<mi>~</mi>
<mo>H</mo>
<mo>+</mo>
<mo>E</mo>
<mi>~</mi>
<mover accent="true"><mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mrow><mo>[</mo><mrow><mo>Sx</mo>
<mi>,</mi>
<mo>Sy</mo>
<mi>,</mi>
<mo>Sz</mo>
</mrow>
<mo>]</mo></mrow>
</mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
The last integral in (3.5.8) is a contour integral - can maxima display that?
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i76)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_358</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">)</span><span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span>  <span class="code_endofline">,</span><span class="code_variable">S</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>A</mo>
<mo>k</mo>
</msub>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>S</mo>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mi>,</mi>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>A</mo>
<mo>k</mo>
</msub>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>=</mo>
<mrow><mo>(</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>−</mo>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
<mo>−</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>E</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mo>−</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>−</mo>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mo>−</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>S</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i81)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_359</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>B</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3510</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">curl</span><span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">D</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
</mrow>
<mi>,</mi>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
</mrow>
</mrow>
<mo>−</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
</mrow>
</mrow>
<mo>]</mo></mrow>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<msub><mo>D</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<mo>ω</mo>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i91)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3511</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_function">express</span><span class="code_operator">(</span><span class="code_function">div</span><span class="code_operator">(</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω</span><span class="code_operator">·</span> <span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">ε_bar</span> <span class="code_operator">−</span> <span class="code_variable">ε_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_variable">μ_bar</span> <span class="code_operator">−</span> <span class="code_variable">μ_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_variable">ξ_bar</span> <span class="code_operator">−</span> <span class="code_variable">ζ_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">H</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_operator">(</span><span class="code_variable">ζ_bar</span> <span class="code_operator">−</span> <span class="code_variable">ξ_bar_dagger</span><span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">E</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">)</span>   <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>x</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>−</mo>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
<mo>−</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>y</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mo>−</mo>
<msub><mo>E</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mo>−</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>+</mo>
<mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>−</mo>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mo>−</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mo>%i</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><msub><mo>ζ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ξ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mrow><mo>(</mo><mrow><msub><mo>ξ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ζ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>H</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mrow><mo>(</mo><mrow><msub><mo>μ</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>μ_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>H</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>H</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Hk</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<mrow><mo>(</mo><mrow><msub><mo>ε</mo>
<mo>bar</mo>
</msub>
<mo>−</mo>
<mo>ε_bar_dagger</mo>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<mrow><mo>(</mo><mrow><msub><mo>E</mo>
<mo>z</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mo>+</mo>
<msub><mo>E</mo>
<mo>x</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>Ek</mo>
<mo>x</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<mo>ω</mo>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>−</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i96)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3512</span><span class="code_operator">:</span><span class="code_operator">[</span> <span class="code_variable">pma</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">n_i</span><span class="code_operator">[</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span>  <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">n_i</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">1</span><span class="code_endofline">,</span> <span class="code_variable">N</span><span class="code_operator">)</span><span class="code_endofline">,</span>  <span class="code_variable">pma</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_variable">n_i</span><span class="code_operator">[</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span>  <span class="code_operator">+</span> <span class="code_variable">n_i</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">pma</span> <span class="code_operator">=</span>  <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_variable">n_b</span><span class="code_operator">[</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span>  <span class="code_operator">+</span> <span class="code_variable">n_b</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">(</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">~</span> <span class="code_variable">H</span> <span class="code_operator">+</span> <span class="code_variable">E</span> <span class="code_endofline">~</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span><span class="code_variable">pma</span><span class="code_operator">=</span> <span class="code_operator">−</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mo>pma</mo>
<mo>=</mo>
<mo>N</mo>
<mo>&#8290;</mo>
<msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>n</mo>
<mo>i</mo>
</msub>
<mo>p</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<msub><msub><mo>n</mo>
<mo>i</mo>
</msub>
<mo>m</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mi>,</mi>
<mo>pma</mo>
<mo>=</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>n</mo>
<mo>i</mo>
</msub>
<mo>p</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<msub><msub><mo>n</mo>
<mo>i</mo>
</msub>
<mo>m</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>L</mo>
<mo>s</mo>
</msub>
<mi>,</mi>
<mo>pma</mo>
<mo>=</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>n</mo>
<mo>b</mo>
</msub>
<mo>p</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>+</mo>
<msub><msub><mo>n</mo>
<mo>b</mo>
</msub>
<mo>m</mo>
</msub>
<mo> . </mo>
<mrow><mo>(</mo><mrow><mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>H</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>H</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<mrow><mo>[</mo><mrow><msub><mo>E</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>E</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mi>~</mi>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>&#8290;</mo>
<msub><mo>L</mo>
<mo>s</mo>
</msub>
<mi>,</mi>
<mo>pma</mo>
<mo>=</mo>
<mo>−</mo>
<msub><mo>L</mo>
<mo>s</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
<mo>−</mo>
<msub><mo>L</mo>
<mo>s</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><msub><mo>Hk</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Hk</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mrow><mo>[</mo><mrow><msub><mo>Ek</mo>
<mo>x</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>y</mo>
</msub>
<mi>,</mi>
<msub><mo>Ek</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>]</mo></mrow>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i103)	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_endofline">,</span><span class="code_variable">A</span><span class="code_endofline">,</span><span class="code_variable">E</span><span class="code_endofline">,</span><span class="code_variable">H</span><span class="code_endofline">,</span> <span class="code_variable">E_hat</span><span class="code_endofline">,</span> <span class="code_variable">H_hat</span> <span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>done</mo>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
For the excitation amplitudes A[k](z), k = ±m
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i105)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_c3513</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span> <span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span> <span class="code_operator">)</span><span class="code_operator">]</span> <span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>A</mo>
<mo>k</mo>
</msub>
</mrow>
</mrow>
<mo>=</mo>
<mo>−</mo>
<mfrac><mrow><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<mover accent="true"><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
<mo>+</mo>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mover accent="true"><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
<mo>−</mo>
<mfrac><mrow><msub><mo>L</mo>
<mo>s</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
<mo>−</mo>
<mfrac><mrow><msub><mo>S</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><mo>H</mo>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><mo>E</mo>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Text cell -->


<div class="comment">
For the modal amplitudes a[k](z) *exp(-γ[k]*z), k = ±m
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i106)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_c3514</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_operator">'</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span> <span class="code_endofline">,</span><span class="code_variable">z</span><span class="code_operator">)</span>  <span class="code_operator">+</span> <span class="code_variable">γ</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">·</span><span class="code_variable">a</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">=</span> <span class="code_operator">−</span><span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">−</span> <span class="code_operator">(</span><span class="code_number">1</span><span class="code_operator">/</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">·</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">e</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">J_eff</span><span class="code_operator">[</span><span class="code_variable">s</span><span class="code_endofline">,</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_endofline">.</span> <span class="code_operator">'</span><span class="code_function">conjugate</span><span class="code_operator">(</span><span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">k</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">L</span><span class="code_operator">[</span><span class="code_variable">b</span><span class="code_operator">]</span><span class="code_operator">)</span>  <span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><mrow><mfrac><mo>d</mo>
<mrow><mo>d</mo>
<mo>&#8290;</mo>
<mo>z</mo>
</mrow>
</mfrac>
<mrow><mo>&#8290;</mo>
<msub><mo>A</mo>
<mo>k</mo>
</msub>
</mrow>
</mrow>
<mo>+</mo>
<msub><mo>a</mo>
<mo>k</mo>
</msub>
<mo>&#8290;</mo>
<msub><mo>γ</mo>
<mo>k</mo>
</msub>
<mo>=</mo>
<mo>−</mo>
<mfrac><mrow><msub><mo>L</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<mover accent="true"><msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
<mo>+</mo>
<msub><msub><mo>J</mo>
<mo>eff</mo>
</msub>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<mover accent="true"><msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>&#xaf;</mo></mover>
</mrow>
<mo>)</mo></mrow>
</mrow>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
<mo>−</mo>
<mfrac><mrow><msub><mo>L</mo>
<mo>s</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>s</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
<mo>−</mo>
<mfrac><mrow><msub><mo>S</mo>
<mo>b</mo>
</msub>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>m</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
<mo>+</mo>
<msub><mo>J</mo>
<mrow><mo>b</mo>
<mo>,</mo>
<mo>e</mo>
</mrow>
</msub>
<mo> . </mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mo>k</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<msub><mo>N</mo>
<mo>k</mo>
</msub>
</mfrac>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
(%i107)	
  </span></td>
  <td><span class="input">
<span class="code_variable">cmt_ch03_3514_A</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">N</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_operator">]</span> <span class="code_operator">=</span> <span class="code_operator">'</span><span class="code_function">integrate</span><span class="code_operator">(</span> <span class="code_operator">(</span><span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">n</span><span class="code_operator">]</span> <span class="code_operator">−</span> <span class="code_variable">E_hat</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">n</span><span class="code_operator">]</span> <span class="code_endofline">~</span> <span class="code_variable">H_hat</span><span class="code_operator">[</span><span class="code_variable">m</span><span class="code_endofline">,</span><span class="code_variable">p</span><span class="code_operator">]</span> <span class="code_operator">)</span> <span class="code_endofline">.</span> <span class="code_variable">e</span><span class="code_operator">[</span><span class="code_variable">z</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">S</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mo>[</mo><mrow><msub><mo>N</mo>
<mo>m</mo>
</msub>
<mo>=</mo>
<mo>S</mo>
<mo>&#8290;</mo>
<mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mo>−</mo>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>n</mo>
</mrow>
</msub>
<mi>~</mi>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>p</mo>
</mrow>
</msub>
<mo>−</mo>
<msub><msub><mo>E</mo>
<mo>hat</mo>
</msub>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>n</mo>
</mrow>
</msub>
<mi>~</mi>
<msub><msub><mo>H</mo>
<mo>hat</mo>
</msub>
<mrow><mo>m</mo>
<mo>,</mo>
<mo>p</mo>
</mrow>
</msub>
</mrow>
<mo>)</mo></mrow>
<mo> . </mo>
<msub><mo>e</mo>
<mo>z</mo>
</msub>
</mrow>
<mo>)</mo></mrow>
</mrow>
<mo>]</mo></mrow>
</mrow>
</math>

 <hr/>
 <p><small> Created with <a href="https://wxMaxima-developers.github.io/wxmaxima/">wxMaxima</a>.</small></p>
 </body>
</html>
